(()=>{var e={};e.id=781,e.ids=[220,636,781],e.modules={361:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},2015:e=>{"use strict";e.exports=require("react")},2768:()=>{},2830:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(8732),a=s(2341);function n(){return(0,r.jsxs)(a.Html,{lang:"en",children:[(0,r.jsx)(a.Head,{}),(0,r.jsxs)("body",{className:"antialiased",children:[(0,r.jsx)(a.Main,{}),(0,r.jsx)(a.NextScript,{})]})]})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3305:(e,t,s)=>{"use strict";s.r(t),s.d(t,{config:()=>v,default:()=>b,getServerSideProps:()=>S,getStaticPaths:()=>j,getStaticProps:()=>f,reportWebVitals:()=>w,routeModule:()=>A,unstable_getServerProps:()=>q,unstable_getServerSideProps:()=>M,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>P,unstable_getStaticProps:()=>N});var r={};s.r(r),s.d(r,{default:()=>h,getServerSideProps:()=>g});var a=s(3885),n=s(237),i=s(1413),o=s(2830),d=s(9542),l=s(8732),c=s(2015),u=s(6220);let x=require("next/head");var p=s.n(x);require("@mediapipe/face_detection");let m=function({onCheatingDetected:e}){let t=(0,c.useRef)(null),[s,r]=(0,c.useState)(!1);return(0,l.jsxs)("div",{children:[(0,l.jsx)("video",{ref:t,className:"hidden",playsInline:!0}),s&&(0,l.jsx)("div",{className:"fixed top-4 left-4 bg-red-600 text-white px-4 py-2 rounded shadow-md",children:"Warning: Cheating Detected!"})]})};function h({exam:e}){(0,u.useRouter)();let[t,s]=(0,c.useState)({}),[r,a]=(0,c.useState)(!1),[n,i]=(0,c.useState)(2400),[o,d]=(0,c.useState)(0),[x,h]=(0,c.useState)(null),g=(e,t)=>{s(s=>({...s,[e]:t}))},b=async s=>{if(s&&s.preventDefault&&s.preventDefault(),r)return;a(!0);let i=e.questions.reduce((e,s,r)=>t[r]===s.correctAnswer?e+1:e,0),d=e.questions.length,l=2400-n;h(l);let c={examId:e._id,score:i,total:d,passed:i>=40,timeTaken:l,cheatingCount:o,createdAt:new Date};try{await fetch("/api/exams/result",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})}catch(e){console.error("Failed to save exam result:",e)}},f=(e,s,a)=>r?s===e.correctAnswer?"bg-green-100":t[a]===s&&s!==e.correctAnswer?"bg-red-100":"":"cursor-pointer",j=Math.floor(n/60),S=n%60,v=e.questions.reduce((e,s,r)=>t[r]===s.correctAnswer?e+1:e,0);return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(m,{onCheatingDetected:()=>{d(e=>e+1)}}),!r&&(0,l.jsxs)("div",{className:"fixed top-4 right-4 bg-blue-600 text-white px-4 py-2 rounded shadow-md",children:["Time Remaining: ",j,":",S<10?`0${S}`:S]}),(0,l.jsxs)("div",{className:"p-6 max-w-3xl mx-auto",children:[(0,l.jsx)(p(),{children:(0,l.jsx)("title",{children:e.title})}),(0,l.jsx)("h1",{className:"text-3xl font-bold mb-6",children:e.title}),(0,l.jsxs)("form",{onSubmit:b,children:[e.questions.map((e,s)=>(0,l.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-4 mb-6 border border-gray-200",children:[(0,l.jsx)("p",{className:"text-lg font-medium mb-3",children:e.questionText}),(0,l.jsx)("div",{children:e.options.map((a,n)=>(0,l.jsxs)("label",{className:`block p-2 mb-2 border rounded ${f(e,a,s)}`,children:[(0,l.jsx)("input",{type:"radio",name:`question-${s}`,value:a,checked:t[s]===a,onChange:()=>g(s,a),className:"mr-2",disabled:r}),a]},n))}),r&&(0,l.jsx)("p",{className:"mt-2",children:t[s]===e.correctAnswer?(0,l.jsx)("span",{className:"text-green-600 font-semibold",children:"Correct!"}):(0,l.jsxs)("span",{className:"text-red-600 font-semibold",children:["Incorrect. Correct answer: ",e.correctAnswer]})})]},s)),!r&&(0,l.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded",children:"Submit Answers"}),r&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("p",{className:"text-xl font-bold",children:["You got ",v," out of ",e.questions.length," correct!"]}),(0,l.jsx)("p",{className:"text-lg",children:v>=40?"Congratulations! You have passed the exam.":"Sorry, you did not pass the exam."}),null!==x&&(0,l.jsxs)("p",{className:"text-lg",children:["Time Taken: ",Math.floor(x/60)," minutes ",x%60," seconds."]}),(0,l.jsxs)("p",{className:"text-lg",children:["Cheating Attempts: ",o]})]})]})]})]})}async function g({params:e,req:t}){let s=t.headers["x-forwarded-proto"]||"http",r=t.headers.host,a=`${s}://${r}/api/exams/${e.id}`,n=await fetch(a);if(!n.ok)return console.error("API error response:",await n.text()),{notFound:!0};let i=await n.json();return{props:{exam:i=JSON.parse(JSON.stringify(i))}}}let b=(0,i.M)(r,"default"),f=(0,i.M)(r,"getStaticProps"),j=(0,i.M)(r,"getStaticPaths"),S=(0,i.M)(r,"getServerSideProps"),v=(0,i.M)(r,"config"),w=(0,i.M)(r,"reportWebVitals"),N=(0,i.M)(r,"unstable_getStaticProps"),P=(0,i.M)(r,"unstable_getStaticPaths"),y=(0,i.M)(r,"unstable_getStaticParams"),q=(0,i.M)(r,"unstable_getServerProps"),M=(0,i.M)(r,"unstable_getServerSideProps"),A=new a.PagesRouteModule({definition:{kind:n.A.PAGES,page:"/exam/[id]",pathname:"/exam/[id]",bundlePath:"",filename:""},components:{App:d.default,Document:o.default},userland:r})},3873:e=>{"use strict";e.exports=require("path")},4722:e=>{"use strict";e.exports=require("next-auth/react")},8732:e=>{"use strict";e.exports=require("react/jsx-runtime")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9542:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(8732);s(2768);var a=s(4722);function n({Component:e,pageProps:t}){return(0,r.jsx)(a.SessionProvider,{session:t.session,children:(0,r.jsx)(e,{...t})})}}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[341,20],()=>s(3305));module.exports=r})();