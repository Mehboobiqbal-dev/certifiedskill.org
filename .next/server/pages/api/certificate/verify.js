"use strict";(()=>{var e={};e.id=932,e.ids=[932],e.modules={1278:e=>{e.exports=require("pdfkit")},3480:(e,t,o)=>{e.exports=o(5600)},4689:(e,t,o)=>{o.d(t,{A:()=>l});var i=o(6037),n=o.n(i);if(!process.env.MONGO_URI)throw Error("Please define the MONGO_URI environment variable");let r=global.mongoose;r||(r=global.mongoose={conn:null,promise:null});let l=async function(){return r.conn||(r.promise||(r.promise=n().connect(process.env.MONGO_URI,{useNewUrlParser:!0,useUnifiedTopology:!0}).then(()=>n().connection)),r.conn=await r.promise),r.conn}},5411:(e,t,o)=>{o.r(t),o.d(t,{config:()=>u,default:()=>d,routeModule:()=>p});var i={};o.r(i),o.d(i,{default:()=>c});var n=o(3480),r=o(8667),l=o(6435),a=o(1278),s=o.n(a),f=o(4689);async function c(e,t){if("GET"!==e.method)return t.status(405).json({message:"Method Not Allowed"});try{let{certificateNumber:o}=e.query;if(!o)return t.status(400).json({message:"Certificate number is required"});let i=await (0,f.A)(),n=i.db||i.useDb("myDatabase"),r=await n.collection("certificates").findOne({certificateId:o});if(!r)return t.status(404).json({message:"Certificate not found"});t.setHeader("Content-Type","application/pdf"),t.setHeader("Content-Disposition",'inline; filename="certificate.pdf"');let l=new(s())({size:"A4",layout:"landscape",margins:{top:50,bottom:50,left:50,right:50}});l.pipe(t);let{width:a,height:c}=l.page;l.rect(0,0,a,c).fill("#ffffff"),l.rect(30,30,a-60,c-60).lineWidth(5).stroke("#D32F2F"),l.rect(50,50,a-100,c-100).lineWidth(2).stroke("#333333");let d=(e,t,o,i)=>{l.lineWidth(10).strokeColor("#D32F2F").moveTo(e,t).lineTo(o,i).stroke(),l.lineWidth(7).strokeColor("#333333").moveTo(e+10,t).lineTo(o+10,i).stroke(),l.lineWidth(2).strokeColor("#FFD700").moveTo(e+20,t).lineTo(o+20,i).stroke()};d(50,50,150,150),d(a-150,50,a-50,150),d(50,c-50,150,c-150),d(a-150,c-50,a-50,c-150),l.font("Helvetica-Bold").fontSize(22).fillColor("#333333").text("GetCertified",0,60,{align:"center"}),l.font("Times-Bold").fontSize(38).fillColor("#D32F2F").text("Certificate of Achievement",0,120,{align:"center"}),l.font("Helvetica").fontSize(16).fillColor("#333333").text("This certificate is awarded to",0,180,{align:"center"}),l.font("Helvetica-Bold").fontSize(30).fillColor("#000000").text(r.userName,0,230,{align:"center"}),l.font("Helvetica").fontSize(14).fillColor("#333333").text("In recognition of outstanding performance and dedication.",0,280,{align:"center"});let u=new Date(r.issuedAt).toLocaleDateString();l.font("Helvetica").fontSize(12).fillColor("#333333").text(`Date: ${u}`,60,c-120),l.moveTo(a-220,c-120).lineTo(a-70,c-120).stroke("#333333"),l.font("Helvetica").fontSize(12).text("Authorized Signature",a-200,c-110);let p=a/2-50,m=c-200;l.save();for(let e=0;e<20;e++){let t=50-50*e/20,o=e/19,i=Math.round(184+71*o),n=Math.round(134+81*o),r=Math.round(11+-11*o);l.circle(p+50,m+50,t).fillColor(`rgb(${i},${n},${r})`).fill()}l.restore(),l.lineWidth(4).strokeColor("#C28840").circle(p+50,m+50,50).stroke(),l.font("Times-Bold").fontSize(14).fillColor("#4B3D00").text("BEST AWARD",p,m+30,{width:100,align:"center"}),l.font("Times-Italic").fontSize(10).fillColor("#4B3D00").text("Official Seal",p,m+50,{width:100,align:"center"}),l.end()}catch(e){console.error("Error generating certificate:",e),t.status(500).json({message:"Internal Server Error"})}}let d=(0,l.M)(i,"default"),u=(0,l.M)(i,"config"),p=new n.PagesAPIRouteModule({definition:{kind:r.A.PAGES_API,page:"/api/certificate/verify",pathname:"/api/certificate/verify",bundlePath:"",filename:""},userland:i})},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6037:e=>{e.exports=require("mongoose")},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,o){return o in t?t[o]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,o)):"function"==typeof t&&"default"===o?t:void 0}}})},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return o}});var o=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var o=t(t.s=5411);module.exports=o})();