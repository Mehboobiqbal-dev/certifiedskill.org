"use strict";(()=>{var e={};e.id=932,e.ids=[932],e.modules={8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return i}});var i=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},29955:(e,t,i)=>{i.r(t),i.d(t,{config:()=>v,default:()=>m,routeModule:()=>h});var n={};i.r(n),i.d(n,{default:()=>g});var o=i(33480),r=i(8667),a=i(86435),l=i(81278),s=i.n(l);let c=require("fs");var f=i.n(c);let u=require("path");var d=i.n(u),p=i(64689);async function g(e,t){if("GET"!==e.method)return t.status(405).json({message:"Method Not Allowed"});try{let{certificateNumber:i}=e.query;if(!i)return t.status(400).json({message:"Certificate number is required"});let n=await (0,p.A)(),o=n.db||n.useDb("myDatabase"),r=await o.collection("certificates").findOne({certificateId:i});if(!r)return t.status(404).json({message:"Certificate not found"});t.setHeader("Content-Type","application/pdf"),t.setHeader("Content-Disposition",'inline; filename="certificate.pdf"');let a=new(s())({size:"A4",layout:"landscape",margins:{top:50,bottom:50,left:50,right:50}});a.pipe(t);let{width:l,height:c}=a.page;a.rect(0,0,l,c).fill("#ffffff"),a.rect(40,40,l-80,c-80).lineWidth(2).stroke("#333333"),a.fillColor("#333333").font("Helvetica-Bold").fontSize(20).text("CertifiedSkill.org",0,60,{align:"center"}),a.font("Helvetica").fontSize(12).text("Your trusted partner in professional certifications",{align:"center"}),a.moveDown(2),a.font("Helvetica-Bold").fontSize(36).text("Certificate of Achievement",{align:"center",underline:!0}),a.moveDown(1.5),a.font("Helvetica").fontSize(18).text("This certificate verifies that",{align:"center"}),a.moveDown(.5),a.font("Helvetica-Bold").fontSize(28).text(r.userName,{align:"center"}),a.moveDown(.5),a.font("Helvetica").fontSize(18).text("has successfully passed the exam:",{align:"center"}),a.moveDown(.5),a.font("Helvetica-Bold").fontSize(24).text(r.examName,{align:"center"}),a.moveDown(1.5),a.font("Helvetica").fontSize(14).text("This is an authentic certificate digitally issued by CertifiedSkill.org.",{align:"center"}),a.text("Visit CertifiedSkill.org.com to verify its authenticity.",{align:"center"});let u=new Date(r.issuedAt).toLocaleDateString();a.font("Helvetica").fontSize(10).text(`Certificate ID: ${r.certificateId}`,50,c-70,{align:"left"}),a.font("Helvetica").fontSize(10).text(`Issued on: ${u}`,-50,c-70,{align:"right"});let g=c-100,m=l-200,v=d().join(process.cwd(),"public/image.png");f().existsSync(v)&&a.image(v,m,g-40,{width:100,height:50}),a.moveTo(m,g).lineTo(m+100,g).stroke("#333333"),a.font("Helvetica").fontSize(10).text("Authorized Signature",m,g+5,{align:"center",width:100}),a.end()}catch(e){console.error("Error verifying certificate:",e),t.status(500).json({message:"Internal Server Error"})}}let m=(0,a.M)(n,"default"),v=(0,a.M)(n,"config"),h=new o.PagesAPIRouteModule({definition:{kind:r.A.PAGES_API,page:"/api/certificate/verify",pathname:"/api/certificate/verify",bundlePath:"",filename:""},userland:n})},33480:(e,t,i)=>{e.exports=i(75600)},56037:e=>{e.exports=require("mongoose")},64689:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(56037),o=i.n(n);if(!process.env.MONGO_URI)throw Error("Please define the MONGO_URI environment variable");let r=global.mongoose;r||(r=global.mongoose={conn:null,promise:null});let a=async function(){return r.conn||(r.promise||(r.promise=o().connect(process.env.MONGO_URI).then(e=>e.connection)),r.conn=await r.promise),r.conn}},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},81278:e=>{e.exports=require("pdfkit")},86435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var i=t(t.s=29955);module.exports=i})();