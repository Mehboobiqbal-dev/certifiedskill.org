"use strict";(()=>{var e={};e.id=863,e.ids=[863],e.modules={8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return n}});var n=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},33480:(e,t,n)=>{e.exports=n(75600)},56037:e=>{e.exports=require("mongoose")},64689:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(56037),s=n.n(r);if(!process.env.MONGO_URI)throw Error("Please define the MONGO_URI environment variable");let o=global.mongoose;o||(o=global.mongoose={conn:null,promise:null});let a=async function(){return o.conn||(o.promise||(o.promise=s().connect(process.env.MONGO_URI).then(e=>e.connection)),o.conn=await o.promise),o.conn}},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},84806:(e,t,n)=>{n.r(t),n.d(t,{config:()=>c,default:()=>l,routeModule:()=>d});var r={};n.r(r),n.d(r,{default:()=>u});var s=n(33480),o=n(8667),a=n(86435),i=n(64689);async function u(e,t){if("POST"!==e.method)return t.status(405).json({message:"Method Not Allowed"});try{let{userId:n,examId:r,score:s,total:o,passed:a,timeTaken:u}=e.body;if(!r||!n||null==s||null==o||null==a||null==u)return t.status(400).json({message:"Missing required fields"});let{db:l}=await (0,i.A)(),c=await l.collection("examResults").findOne({examId:r,userId:n});if(c){let e=new Date(c.createdAt);if(new Date-e<6048e5)return t.status(400).json({message:"You already attempted this exam! Please try again after one week."})}let d={examId:r,userId:n,score:s,total:o,passed:a,timeTaken:u,createdAt:new Date};return await l.collection("examResults").insertOne(d),t.status(200).json({message:"Result saved successfully",data:d})}catch(e){return console.error("Error saving exam result:",e),t.status(500).json({message:"Internal Server Error",error:e.message})}}let l=(0,a.M)(r,"default"),c=(0,a.M)(r,"config"),d=new s.PagesAPIRouteModule({definition:{kind:o.A.PAGES_API,page:"/api/exams/result",pathname:"/api/exams/result",bundlePath:"",filename:""},userland:r})},86435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var n=t(t.s=84806);module.exports=n})();